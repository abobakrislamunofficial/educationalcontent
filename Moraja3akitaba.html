<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>اختبار مراجعة الوحدة الرابعة - تفاعلي مع النص</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #2c3e50;
            --accent-color: #3498db;
            --correct-color: #27ae60;
            --incorrect-color: #c0392b;
            --bg-color: #f4f6f7;
            --passage-bg: #fff8e1;
            --passage-border: #ffe082;
            --highlight-color: #ffff00;
        }

        body {
            font-family: 'Tajawal', sans-serif;
            background-color: var(--bg-color);
            margin: 0;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background-color: #ffffff;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #eee;
            padding-bottom: 20px;
        }

        header h1 {
            color: var(--primary-color);
            font-size: 26px;
            margin-bottom: 10px;
        }

        .score-board {
            font-size: 20px;
            font-weight: bold;
            color: var(--accent-color);
            margin-top: 10px;
        }

        .group-section {
            margin-bottom: 40px;
            border-bottom: 2px dashed #ddd;
            padding-bottom: 20px;
        }

        .group-title {
            font-size: 22px;
            color: var(--accent-color);
            margin-bottom: 15px;
            border-right: 5px solid var(--accent-color);
            padding-right: 10px;
        }

        .passage-box {
            background-color: var(--passage-bg);
            border: 1px solid var(--passage-border);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 25px;
            line-height: 2;
            font-size: 18px;
            color: #444;
            text-align: justify;
        }

        .answer-hint {
            transition: background-color 0.3s ease;
            border-radius: 4px;
            padding: 0 2px;
        }

        /* الكلاس الذي سيضاف ويحذف ديناميكياً */
        .highlight-text {
            background-color: var(--highlight-color);
            color: #000;
            font-weight: bold;
            text-decoration: underline;
            box-shadow: 0 0 10px rgba(255, 255, 0, 0.5);
        }

        .question-card {
            background: #fff;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            margin-right: 20px;
        }

        .question-text {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 15px;
            color: var(--primary-color);
        }

        .options-grid {
            display: grid;
            gap: 10px;
        }

        .option-btn {
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            background: #fff;
            cursor: pointer;
            font-family: 'Tajawal', sans-serif;
            font-size: 16px;
            text-align: right;
            transition: all 0.3s ease;
            position: relative;
        }

        .option-btn:hover:not(:disabled) {
            background-color: #f0f8ff;
            border-color: var(--accent-color);
        }

        .option-btn.correct {
            background-color: var(--correct-color) !important;
            color: white !important;
            border-color: var(--correct-color) !important;
        }

        .option-btn.incorrect {
            background-color: var(--incorrect-color) !important;
            color: white !important;
            border-color: var(--incorrect-color) !important;
        }

        .option-btn:disabled {
            cursor: default;
            opacity: 0.9;
        }

        .option-btn.correct::after { content: "✓"; position: absolute; left: 15px; font-weight: bold; }
        .option-btn.incorrect::after { content: "✕"; position: absolute; left: 15px; font-weight: bold; }

        .result-footer {
            text-align: center;
            margin-top: 30px;
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>اختبار مراجعة الوحدة الرابعة - التواصل الكتابي</h1>
        <div class="score-board">النتيجة: <span id="current-score">0</span> / 23</div>
        <p style="font-size: 14px; color: #777; margin-top: 5px;">عند الإجابة، سيتم تظليل موضع الحل في النص (ويختفي عند الانتقال لسؤال آخر).</p>
    </header>

    <div id="quiz-container">
        </div>

    <div class="result-footer">
        <button onclick="location.reload()" style="padding: 12px 25px; background: var(--primary-color); color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 18px; font-family: inherit;">إعادة الاختبار</button>
    </div>
</div>

<script>
    const quizGroups = [
        {
            title: "مقدمة عن الكتابة الجيدة",
            passageHTML: `الكتابة الجيِّدة نتيجة: <span id="h-1" class="answer-hint">قراءة جيِّدة، وتخطيط جيِّد</span>، كل الكُتَّاب إمّا أن يكتبوا في موضوعات يمتلكون ثقافتها جيِّدًا، وإما أن يبذلوا جهدًا كبيرًا في جمع معلوماتها، وفي كلتا الحالتين يبدؤون الكتابة <span id="h-2" class="answer-hint">بتصميم مخطط للموضوع</span> ينظِّم أفكاره، ويحدد جزئياته، ويقترح أساليب العرض، ووسائل التأثير والإقناع.`,
            questions: [
                { id: 1, q: "1. ما العنصران الأساسيان اللذان تعتمد عليهما الكتابة الجيدة؟", options: ["الموهبة والإلهام", "القراءة الجيدة والتخطيط الجيد", "السرعة في الكتابة والخيال الواسع", "الخبرة الطويلة والممارسة المستمرة"], answer: 1 },
                { id: 2, q: "2. ماذا يفعل الكتّاب قبل البدء في الكتابة؟", options: ["يجمعون آراء القراء", "يصممون مخططاً للموضوع", "يكتبون المسودة النهائية", "يختارون دار النشر"], answer: 1 }
            ]
        },
        {
            title: "جمع المعلومات من مصادرها المختلفة",
            passageHTML: `<span id="h-3" class="answer-hint">الْكِتاب هو أهم مصادر المعلومات</span>، <span id="h-4" class="answer-hint">لكنه ليس مصدرها الوحيد</span>، فوسائل الإعلام المختلفة (الصحف والمجلات والإذاعة والتلفاز والنشرات والمطويات...)، والشَّبكة العنكبوتِيَّة، والناس، والملاحظات الشخصية، <span id="h-5" class="answer-hint">كل أولئك – وغيرها – هي مصادر مهمة</span> تُستقى منها المعلومات.`,
            questions: [
                { id: 3, q: "3. أي من التالي يُعد أهم مصادر المعلومات؟", options: ["الشبكة العنكبوتية", "وسائل الإعلام المختلفة", "الكتاب", "الملاحظات الشخصية"], answer: 2 },
                { id: 4, q: "4. هل الكتاب هو المصدر الوحيد للمعلومات؟", options: ["نعم، هو المصدر الوحيد الموثوق", "لا، هناك مصادر أخرى متعددة", "نعم، في المجالات العلمية فقط", "لا، إلا في حالة البحث الأكاديمي"], answer: 1 },
                { id: 5, q: "5. أي من التالي يُعد من مصادر المعلومات المهمة؟", options: ["الكتب فقط", "الصحف والمجلات فقط", "الشبكة العنكبوتية والملاحظات الشخصية فقط", "جميع ما ذُكر من وسائل إعلام وناس وملاحظات"], answer: 3 }
            ]
        },
        {
            title: "تحديد الهدف من الكتابة",
            passageHTML: `<span id="h-6" class="answer-hint">يتحكم الهدف من الكتابة في اختيار الفن التعبيري المناسب</span> لتحقيقه، فإذا كان الهدف أن تُبَلِّغ صديقك ببعض أمورك فمن المناسب أن تكتب إليه (<span id="h-7" class="answer-hint">رسالة</span>)، وإذا كنت تهدف إلى المشاركة في مناقشة موضوع صحفي فمن الأنسب أن تكتب (<span id="h-8" class="answer-hint">مقالًا</span>)، أما لو كنت تهدف إلى التعبير عن عواطفك وانفعالاتك تجاه حدث معين فقد يكون من الأفضل أن تكتب (<span id="h-9" class="answer-hint">قصيدة) أو (قصة</span>).`,
            questions: [
                { id: 6, q: "6. ما العامل الذي يحدد اختيار الفن التعبيري المناسب؟", options: ["مستوى ثقافة الكاتب", "الهدف من الكتابة", "طول النص المطلوب", "نوع الجمهور المستهدف"], answer: 1 },
                { id: 7, q: "7. إذا أراد شخص أن يُبلّغ صديقه ببعض أموره، فما الفن التعبيري الأنسب؟", options: ["المقالة", "القصيدة", "الرسالة", "القصة"], answer: 2 },
                { id: 8, q: "8. ما الفن التعبيري الأفضل للمشاركة في مناقشة موضوع صحفي؟", options: ["الرسالة", "المقالة", "القصة", "اليوميات"], answer: 1 },
                { id: 9, q: "9. أي فن تعبيري يناسب التعبير عن العواطف والانفعالات تجاه حدث معين؟", options: ["المقالة أو التقرير", "الرسالة أو البرقية", "القصيدة أو القصة", "الخطبة أو المحاضرة"], answer: 2 }
            ]
        },
        {
            title: "تصميم مخطط الموضوع",
            passageHTML: `<span id="h-10" class="answer-hint">عليك أولاً أن تحدد العناصر الفنية</span> للفن التعبيري الذي اخترته، فالمقالة مثلا، تتكون من (<span id="h-11" class="answer-hint">عنوان ومقدِّمة وعرض وخاتمة</span>)، والقصة تتكون من (<span id="h-12" class="answer-hint">زمان / ومكان / وبطل / وشخصيات ثانوية / وأحداث / وحبكة قصصية</span>)، وهكذا لكل فن عناصره الخاصة. ثم تحدد الأفكار الرئيسة التي ستتحدث عنها في كل عنصر، مرتبة حسب تسلسل مناسب. <span id="h-13" class="answer-hint">وتفرِّع كل فكرة رئيسة إلى جزئياتها التفصيلية</span>. ثُمَّ تفكِّر في الأسلوب الذي ستنظم به جزئيات الفكرة، ووسائل الإقناع والتأثير المناسبة. يمكنك أن تلخِّص مخططًا في <span id="h-14" class="answer-hint">جدول، أو تستخدم شجرة الذاكرة، أو مخطط هيكل السمكة</span>. والمهم <span id="h-15" class="answer-hint">ألا تبدأ كتابة موضوعك قبل أن تصمم مخططًا مناسبًا له</span>.`,
            questions: [
                { id: 10, q: "10. ما الخطوة الأولى في تصميم مخطط الموضوع؟", options: ["تحديد الأفكار الرئيسة", "ترتيب الأفكار حسب تسلسل مناسب", "تحديد العناصر الفنية للفن التعبيري", "التفكير في أساليب الإقناع والتأثير"], answer: 2 },
                { id: 11, q: "11. كم عدد العناصر الفنية التي تتكون منها المقالة؟", options: ["ثلاثة عناصر", "خمسة عناصر", "أربعة عناصر", "ستة عناصر"], answer: 2 },
                { id: 12, q: "12. أي من التالي ليس من مكونات القصة؟", options: ["الزمان والمكان", "البطل والشخصيات الثانوية", "المقدمة والخاتمة", "الأحداث والحبكة القصصية"], answer: 2 },
                { id: 13, q: "13. ماذا يفعل الكاتب بعد تحديد الأفكار الرئيسة؟", options: ["يكتب المسودة الأولى مباشرة", "يفرّع كل فكرة رئيسة إلى جزئياتها التفصيلية", "يبدأ بكتابة الخاتمة", "يعرض عمله على الآخرين"], answer: 1 },
                { id: 14, q: "14. أي من الأدوات التالية يمكن استخدامها لتلخيص مخطط الموضوع؟", options: ["الجدول فقط", "شجرة الذاكرة فقط", "مخطط هيكل السمكة فقط", "جميع ما سبق"], answer: 3 },
                { id: 15, q: "15. متى يجب على الكاتب أن يبدأ كتابة موضوعه؟", options: ["فور اختيار الموضوع مباشرة", "بعد جمع بعض المعلومات", "بعد تصميم مخطط مناسب", "بعد مناقشة الفكرة مع الآخرين"], answer: 2 }
            ]
        },
        {
            title: "كتابة الموضوع - المواصفات",
            passageHTML: `الموضوع الجيّد هو الذي تتوافر فيه المواصفات الآتية: عنوان: <span id="h-16" class="answer-hint">قصير ومثير ودال على المحتوى</span>. <span id="h-17" class="answer-hint">مقدمة: قصيرة ومشَوِّقة</span> وممهدة للموضوع. فقرات مبنية بناء جيِّدًا. <span id="h-19" class="answer-hint">أفكار مرتبة وفق سلسلة منطقية سليمة</span>. خاتمة: <span id="h-20" class="answer-hint">تلخِّص أفكاره، أو تبيّن الرأي النهائي للكاتب</span>، أو تقدّم بعض المقترحات أو التوصيات.`,
            questions: [
                { id: 16, q: "16. ما صفة العنوان الجيد من حيث الطول؟", options: ["طويل ومفصّل", "قصير ومختصر", "متوسط الطول", "لا يهم طوله"], answer: 1 },
                { id: 17, q: "17. أي من التالي ليس من صفات العنوان الجيد؟", options: ["قصير", "مثير", "طويل ومفصّل", "دال على المحتوى"], answer: 2 },
                { id: 18, q: "18. أي من التالي ليس من صفات المقدمة الجيدة؟", options: ["قصيرة", "مشوقة", "مفصّلة وشاملة", "ممهدة للموضوع"], answer: 2 },
                { id: 19, q: "19. كيف يجب أن تكون الأفكار في الموضوع الجيد؟", options: ["كثيرة ومتنوعة بغض النظر عن الترتيب", "مرتبة وفق سلسلة منطقية سليمة", "مختصرة وقليلة العدد", "متشابهة ومكررة للتأكيد"], answer: 1 },
                { id: 20, q: "20. ما الذي يجب أن تركز عليه الخاتمة الجيدة؟", options: ["إضافة معلومات جديدة لم تُذكر في الموضوع", "تكرار المقدمة بصياغة مختلفة", "تلخيص الأفكار أو بيان الرأي النهائي", "طرح أسئلة جديدة للقارئ"], answer: 2 }
            ]
        },
        {
            title: "المسودة والمراجعة",
            passageHTML: `في الكتابة الأولى (المسودة) اهتم فقط <span id="h-21" class="answer-hint">باستيفاء جميع الأفكار والجزئيات</span>، وحاول تطبيق المقترحات التي دوَّنتها في المخطط. دع التنقيح، وجودة بناء الفقرات، وقوة التأثير والإقناع <span id="h-22" class="answer-hint">للمراجعة</span>، ثم اكتب (مبيضة) موضوعك في ضوء نتائج المراجعة، وتذكّر أنه لا يوجد كاتب في الدنيا يخرج للناس ما كتبه لأول مرة، فدائما يراجع الكُتَّاب موضوعاتهم مرارًا قبل أن يعرضوها على الناس، <span id="h-23" class="answer-hint">فالمراجعة والتنقيح تُنتج كتابة جيّدة</span>.`,
            questions: [
                { id: 21, q: "21. على ماذا يجب التركيز في المسودة الأولى للكتابة؟", options: ["جمال الأسلوب وقوة التعبير", "استيفاء جميع الأفكار والجزئيات", "التنقيح وتصحيح الأخطاء", "جودة بناء الفقرات"], answer: 1 },
                { id: 22, q: "22. متى يتم الاهتمام بالتنقيح وجودة بناء الفقرات؟", options: ["أثناء الكتابة الأولى", "قبل تصميم المخطط", "في مرحلة المراجعة", "عند اختيار الموضوع"], answer: 2 },
                { id: 23, q: "23. ما الذي تُنتجه المراجعة والتنقيح؟", options: ["أفكاراً جديدة", "مخططاً أفضل", "كتابة جيدة", "موضوعات إضافية"], answer: 2 }
            ]
        }
    ];

    let score = 0;
    let globalQuestionIndex = 0;
    const quizContainer = document.getElementById('quiz-container');
    const currentScoreEl = document.getElementById('current-score');

    function renderQuiz() {
        quizGroups.forEach((group, gIndex) => {
            const groupSection = document.createElement('div');
            groupSection.className = 'group-section';

            const groupTitle = document.createElement('h2');
            groupTitle.className = 'group-title';
            groupTitle.textContent = group.title;
            groupSection.appendChild(groupTitle);

            const passageBox = document.createElement('div');
            passageBox.className = 'passage-box';
            passageBox.innerHTML = group.passageHTML;
            groupSection.appendChild(passageBox);

            group.questions.forEach((question, qIndex) => {
                const uniqueId = globalQuestionIndex++;
                
                const questionCard = document.createElement('div');
                questionCard.className = 'question-card';

                const questionText = document.createElement('div');
                questionText.className = 'question-text';
                questionText.textContent = question.q;
                questionCard.appendChild(questionText);

                const optionsGrid = document.createElement('div');
                optionsGrid.className = 'options-grid';

                question.options.forEach((opt, optIndex) => {
                    const btn = document.createElement('button');
                    btn.className = 'option-btn';
                    btn.textContent = opt;
                    btn.id = `q${uniqueId}-opt${optIndex}`;
                    btn.onclick = () => checkAnswer(btn, uniqueId, optIndex, question.answer, question.id);
                    optionsGrid.appendChild(btn);
                });

                questionCard.appendChild(optionsGrid);
                groupSection.appendChild(questionCard);
            });

            quizContainer.appendChild(groupSection);
        });
    }

    function checkAnswer(selectedBtn, uniqueQId, selectedOptionIndex, correctOptionIndex, questionId) {
        const buttons = document.querySelectorAll(`[id^='q${uniqueQId}-opt']`);
        
        if (selectedBtn.disabled) return;

        buttons.forEach(btn => btn.disabled = true);

        const correctBtn = document.getElementById(`q${uniqueQId}-opt${correctOptionIndex}`);

        // هنا التغيير: مسح التظليل السابق ثم وضع التظليل الجديد
        highlightPassageText(questionId);

        if (selectedOptionIndex === correctOptionIndex) {
            selectedBtn.classList.add('correct');
            score++;
            currentScoreEl.textContent = score;
        } else {
            selectedBtn.classList.add('incorrect');
            correctBtn.classList.add('correct');
        }
    }

    // دالة لتظليل النص في الفقرة مع مسح التظليل السابق
    function highlightPassageText(questionId) {
        // 1. مسح أي تظليل موجود حالياً في أي مكان في الصفحة
        const existingHighlights = document.querySelectorAll('.highlight-text');
        existingHighlights.forEach(el => {
            el.classList.remove('highlight-text');
        });

        // 2. تحديد العنصر الجديد لتظليله
        let targetId = questionId;
        if (questionId === 17) targetId = 16;
        if (questionId === 18) targetId = 17;

        const hintElement = document.getElementById(`h-${targetId}`);
        if (hintElement) {
            hintElement.classList.add('highlight-text');
        }
    }

    renderQuiz();
</script>

</body>
</html>
